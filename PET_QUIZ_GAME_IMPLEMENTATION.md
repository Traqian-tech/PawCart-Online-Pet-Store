# 🧠 Pet Quiz Game Implementation

## ✅ 完成状态

Pet Quiz（宠物知识答题）游戏已完全实现并集成到钱包系统中！

---

## 📁 文件位置

### 前端文件
```
client/src/pages/games/pet-quiz.tsx    # Pet Quiz 游戏页面
client/src/App.tsx                      # 添加了 /wallet/games/quiz 路由
```

### 路由
```
/wallet/games/quiz                      # Pet Quiz 游戏入口
```

---

## 🎮 游戏功能

### 核心玩法
1. **随机题库**：从10道题中随机抽取5题
2. **计时答题**：每题20秒倒计时
3. **难度分级**：Easy、Medium、Hard 三种难度
4. **即时反馈**：答题后立即显示正确答案和解释
5. **积分系统**：
   - Easy 题：10 分
   - Medium 题：20 分
   - Hard 题：30 分

### 奖励机制
- **基础奖励**：每答对1题 = $1.00
- **最高奖励**：全对5题 = $5.00
- **会员加成**：
  - Silver Paw: 1.2x
  - Golden Paw: 1.5x
  - Diamond Paw: 2.0x

### 游戏限制
- 🎯 每天只能玩 **1次**
- ⏰ 每题 **20秒** 答题时间
- 📚 每次 **5道题**

---

## 📚 题库内容

### 当前包含10道宠物知识题：

1. **猫咪睡眠时间** (Easy)
   - 猫咪每天睡多久？
   - 答案：16-18小时

2. **猫咪平均寿命** (Medium)
   - 室内猫平均寿命？
   - 答案：13-17年

3. **猫咪牙齿数量** (Hard)
   - 成年猫有多少颗牙齿？
   - 答案：30颗

4. **猫群称呼** (Medium)
   - 一群猫叫什么？
   - 答案：clowder

5. **猫咪有毒食物** (Easy)
   - 哪种食物对猫有毒？
   - 答案：洋葱和大蒜

6. **猫咪奔跑速度** (Medium)
   - 家猫最快奔跑速度？
   - 答案：30 mph

7. **猫咪骨骼数量** (Hard)
   - 猫有多少块骨头？
   - 答案：244块

8. **猫咪体温** (Hard)
   - 猫咪正常体温范围？
   - 答案：100.5-102.5°F

9. **猫咪味觉** (Medium)
   - 猫最弱的感官是？
   - 答案：味觉

10. **猫咪理毛时间** (Easy)
    - 猫咪花多少时间理毛？
    - 答案：30-50%

---

## 🎨 用户界面

### 游戏状态

#### 1. 准备状态 (Ready)
- 游戏信息展示
  - 题目数量：5题
  - 每题时间：20秒
  - 最高奖励：显示会员加成后金额
  - 会员倍数：显示当前倍数
- 每日限制提示
- 游戏说明
- "Start Quiz" 按钮

#### 2. 游戏中 (Playing)
- **进度条**：显示第几题/总题数、当前分数
- **倒计时**：20秒倒计时，少于5秒变红色警告
- **题目卡片**：
  - 题目内容
  - 难度标签（Easy/Medium/Hard）
  - 4个选项按钮
- **答案反馈**：
  - ✅ 正确：绿色背景 + 勾号
  - ❌ 错误：红色背景 + 叉号
  - 显示正确答案和详细解释
- **操作按钮**：
  - 答题前：Submit Answer
  - 答题后：Next Question / Finish Quiz

#### 3. 完成状态 (Finished)
- 🏆 Trophy 图标
- 游戏结果展示：
  - 总分数
  - 正确题数
  - 获得奖励（含会员加成）
- 操作按钮：
  - Back to Games
  - View Wallet

---

## 🎯 游戏机制

### 答题流程
```
开始游戏
  ↓
从题库随机抽取5题
  ↓
显示第1题 + 开始20秒倒计时
  ↓
用户选择答案
  ↓
提交答案 (或超时自动提交)
  ↓
显示正确答案 + 解释 + 得分
  ↓
下一题 (重复2-5次)
  ↓
游戏结束 - 显示总分和奖励
  ↓
提交分数到后端 - 获得奖励
```

### 积分计算
```typescript
每题得分 = 
  - Easy题答对：10分
  - Medium题答对：20分
  - Hard题答对：30分
  - 答错或超时：0分

总分 = 所有题目得分之和
正确题数 = 答对的题目数量
```

### 奖励计算
```typescript
基础奖励 = 正确题数 × $1.00
最终奖励 = 基础奖励 × 会员倍数

示例：
- 答对5题，无会员：$5.00
- 答对5题，Silver Paw：$6.00
- 答对5题，Golden Paw：$7.50
- 答对5题，Diamond Paw：$10.00
- 答对3题，无会员：$3.00
```

---

## 🔌 API 集成

### 使用的 API 端点

1. **获取游戏状态**
   ```typescript
   GET /api/games/daily-status
   // 检查今天是否已玩过 Quiz
   ```

2. **提交游戏结果**
   ```typescript
   POST /api/games/quiz
   Body: { score: number }
   // 提交分数，获得奖励
   ```

3. **刷新钱包**
   ```typescript
   // 通过 WalletContext 的 refreshWallet() 更新余额
   ```

---

## 🎨 样式设计

### 颜色方案
- **主色调**：蓝色到紫色渐变
- **背景**：from-blue-50 via-purple-50 to-pink-50
- **正确答案**：绿色系 (green-100/500/600)
- **错误答案**：红色系 (red-100/500/600)
- **选中答案**：紫色系 (purple-100/500)
- **难度标签**：
  - Easy: 绿色 (green-100/700)
  - Medium: 黄色 (yellow-100/700)
  - Hard: 红色 (red-100/700)

### 动画效果
- 进度条平滑过渡
- 答案选项 hover 效果
- 倒计时少于5秒时警告动画
- 按钮渐变色 hover 效果

---

## 📱 响应式设计

- ✅ 移动端适配
- ✅ 触摸友好的按钮大小
- ✅ 清晰的视觉反馈
- ✅ 自适应布局

---

## 🔒 安全限制

1. **每日限制**：每天只能玩1次
2. **登录要求**：必须登录才能玩
3. **超时机制**：20秒未答题自动提交（算错误）
4. **分数验证**：后端验证分数合理性
5. **防作弊**：题目随机，无法预测

---

## 🧪 测试步骤

### 1. 访问游戏
```
1. 登录账户
2. 点击 Header 中的 "Wallet"
3. 点击 "Play Games"
4. 点击 "Pet Quiz" 卡片的 "Play Now"
```

### 2. 开始游戏
```
1. 查看游戏信息和说明
2. 点击 "Start Quiz 🧠"
3. 系统随机抽取5道题
```

### 3. 答题过程
```
1. 阅读题目和4个选项
2. 注意倒计时（20秒）
3. 选择一个答案
4. 点击 "Submit Answer"
5. 查看正确答案和解释
6. 点击 "Next Question"
7. 重复直到完成5题
```

### 4. 游戏结束
```
1. 查看总分、正确题数
2. 查看获得的奖励（含会员加成）
3. 点击 "View Wallet" 确认余额增加
```

### 5. 每日限制测试
```
1. 尝试再次玩 Pet Quiz
2. 应该看到 "Come Back Tomorrow!" 按钮（禁用状态）
3. 显示下次可玩时间
```

---

## 💡 功能亮点

### 1. 教育价值
- 涵盖宠物健康、行为、护理等知识
- 每题都有详细解释
- 寓教于乐

### 2. 游戏性
- 随机题库，每次不同
- 倒计时增加挑战性
- 难度分级，平衡趣味和挑战

### 3. 即时反馈
- 答题后立即显示结果
- 详细的知识点解释
- 清晰的视觉提示（颜色、图标）

### 4. 公平性
- 题目随机，无法记忆顺序
- 每天限制1次，防止刷分
- 超时自动提交，防止作弊

### 5. 用户体验
- 美观的渐变色设计
- 流畅的动画过渡
- 清晰的游戏流程
- 友好的错误提示

---

## 🔄 后端支持

### 已实现的后端功能
✅ Pet Quiz API (`POST /api/games/quiz`)
✅ 每日游戏状态检查
✅ 会员奖励倍数计算
✅ 钱包余额更新
✅ 交易记录保存
✅ 每日限制检查（1次/天）

---

## 📊 数据统计

### GameRecord 记录字段
```typescript
{
  userId: string,
  gameType: 'QUIZ',
  score: number,           // 游戏总分
  reward: number,          // 实际奖励金额
  createdAt: Date,         // 游戏时间
}
```

### WalletTransaction 记录
```typescript
{
  type: 'EARN',
  source: 'GAME_QUIZ',
  amount: number,          // 奖励金额
  description: 'Earned from Pet Quiz game',
  balanceBefore: number,
  balanceAfter: number,
  createdAt: Date,
}
```

---

## 🎉 总结

Pet Quiz 游戏是一个：
- ✅ **教育性**：学习宠物知识
- ✅ **趣味性**：挑战答题游戏
- ✅ **奖励性**：获得钱包余额
- ✅ **互动性**：即时反馈和解释
- ✅ **公平性**：随机题库和每日限制

完美融入 PawCart 钱包系统，为用户提供有价值的娱乐体验！

---

## 🚀 扩展建议

### 未来可以添加的功能：
1. **排行榜**：显示高分玩家
2. **更多题库**：扩展到50+题目
3. **题目分类**：猫、狗、兔子等不同类别
4. **连胜奖励**：连续答对额外奖励
5. **好友挑战**：邀请朋友对战
6. **成就系统**：解锁成就徽章
7. **题目贡献**：用户可提交新题目
8. **多语言支持**：英文、中文题库

---

## 📞 支持

如有问题，请联系开发团队或查看相关文档：
- `WALLET_SYSTEM_SUMMARY.md` - 钱包系统总览
- `server/wallet-routes.ts` - 后端 API 实现
- `client/src/contexts/wallet-context.tsx` - 钱包 Context

